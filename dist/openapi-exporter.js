/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function G(e){return typeof e>"u"||e===null}function le(e){return typeof e=="object"&&e!==null}function ue(e){return Array.isArray(e)?e:G(e)?[]:[e]}function ce(e,r){var t,n,i,s;if(r)for(s=Object.keys(r),t=0,n=s.length;t<n;t+=1)i=s[t],e[i]=r[i];return e}function fe(e,r){var t="",n;for(n=0;n<r;n+=1)t+=e;return t}function pe(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}var he=G,me=le,ge=ue,de=fe,xe=pe,ye=ce,x={isNothing:he,isObject:me,toArray:ge,repeat:de,isNegativeZero:xe,extend:ye};function V(e,r){var t="",n=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(t+='in "'+e.mark.name+'" '),t+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!r&&e.mark.snippet&&(t+=`

`+e.mark.snippet),n+" "+t):n}function w(e,r){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=r,this.message=V(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}w.prototype=Object.create(Error.prototype);w.prototype.constructor=w;w.prototype.toString=function(r){return this.name+": "+V(this,r)};var g=w,ve=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Se=["scalar","sequence","mapping"];function Ae(e){var r={};return e!==null&&Object.keys(e).forEach(function(t){e[t].forEach(function(n){r[String(n)]=t})}),r}function Ee(e,r){if(r=r||{},Object.keys(r).forEach(function(t){if(ve.indexOf(t)===-1)throw new g('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=r,this.tag=e,this.kind=r.kind||null,this.resolve=r.resolve||function(){return!0},this.construct=r.construct||function(t){return t},this.instanceOf=r.instanceOf||null,this.predicate=r.predicate||null,this.represent=r.represent||null,this.representName=r.representName||null,this.defaultStyle=r.defaultStyle||null,this.multi=r.multi||!1,this.styleAliases=Ae(r.styleAliases||null),Se.indexOf(this.kind)===-1)throw new g('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}var h=Ee;function k(e,r){var t=[];return e[r].forEach(function(n){var i=t.length;t.forEach(function(s,a){s.tag===n.tag&&s.kind===n.kind&&s.multi===n.multi&&(i=a)}),t[i]=n}),t}function we(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},r,t;function n(i){i.multi?(e.multi[i.kind].push(i),e.multi.fallback.push(i)):e[i.kind][i.tag]=e.fallback[i.tag]=i}for(r=0,t=arguments.length;r<t;r+=1)arguments[r].forEach(n);return e}function N(e){return this.extend(e)}N.prototype.extend=function(r){var t=[],n=[];if(r instanceof h)n.push(r);else if(Array.isArray(r))n=n.concat(r);else if(r&&(Array.isArray(r.implicit)||Array.isArray(r.explicit)))r.implicit&&(t=t.concat(r.implicit)),r.explicit&&(n=n.concat(r.explicit));else throw new g("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(s){if(!(s instanceof h))throw new g("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new g("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new g("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(s){if(!(s instanceof h))throw new g("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(N.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=k(i,"implicit"),i.compiledExplicit=k(i,"explicit"),i.compiledTypeMap=we(i.compiledImplicit,i.compiledExplicit),i};var _e=N,Fe=new h("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return e!==null?e:""}}),Oe=new h("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return e!==null?e:[]}}),Te=new h("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return e!==null?e:{}}}),Ce=new _e({explicit:[Fe,Oe,Te]});function Ne(e){if(e===null)return!0;var r=e.length;return r===1&&e==="~"||r===4&&(e==="null"||e==="Null"||e==="NULL")}function Re(){return null}function Ie(e){return e===null}var Le=new h("tag:yaml.org,2002:null",{kind:"scalar",resolve:Ne,construct:Re,predicate:Ie,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function be(e){if(e===null)return!1;var r=e.length;return r===4&&(e==="true"||e==="True"||e==="TRUE")||r===5&&(e==="false"||e==="False"||e==="FALSE")}function De(e){return e==="true"||e==="True"||e==="TRUE"}function Pe(e){return Object.prototype.toString.call(e)==="[object Boolean]"}var Me=new h("tag:yaml.org,2002:bool",{kind:"scalar",resolve:be,construct:De,predicate:Pe,represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function ke(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function Be(e){return 48<=e&&e<=55}function Ye(e){return 48<=e&&e<=57}function Ue(e){if(e===null)return!1;var r=e.length,t=0,n=!1,i;if(!r)return!1;if(i=e[t],(i==="-"||i==="+")&&(i=e[++t]),i==="0"){if(t+1===r)return!0;if(i=e[++t],i==="b"){for(t++;t<r;t++)if(i=e[t],i!=="_"){if(i!=="0"&&i!=="1")return!1;n=!0}return n&&i!=="_"}if(i==="x"){for(t++;t<r;t++)if(i=e[t],i!=="_"){if(!ke(e.charCodeAt(t)))return!1;n=!0}return n&&i!=="_"}if(i==="o"){for(t++;t<r;t++)if(i=e[t],i!=="_"){if(!Be(e.charCodeAt(t)))return!1;n=!0}return n&&i!=="_"}}if(i==="_")return!1;for(;t<r;t++)if(i=e[t],i!=="_"){if(!Ye(e.charCodeAt(t)))return!1;n=!0}return!(!n||i==="_")}function je(e){var r=e,t=1,n;if(r.indexOf("_")!==-1&&(r=r.replace(/_/g,"")),n=r[0],(n==="-"||n==="+")&&(n==="-"&&(t=-1),r=r.slice(1),n=r[0]),r==="0")return 0;if(n==="0"){if(r[1]==="b")return t*parseInt(r.slice(2),2);if(r[1]==="x")return t*parseInt(r.slice(2),16);if(r[1]==="o")return t*parseInt(r.slice(2),8)}return t*parseInt(r,10)}function He(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!x.isNegativeZero(e)}var qe=new h("tag:yaml.org,2002:int",{kind:"scalar",resolve:Ue,construct:je,predicate:He,represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),$e=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Ke(e){return!(e===null||!$e.test(e)||e[e.length-1]==="_")}function ze(e){var r,t;return r=e.replace(/_/g,"").toLowerCase(),t=r[0]==="-"?-1:1,"+-".indexOf(r[0])>=0&&(r=r.slice(1)),r===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:r===".nan"?NaN:t*parseFloat(r,10)}var Ge=/^[-+]?[0-9]+e/;function Ve(e,r){var t;if(isNaN(e))switch(r){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(r){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(r){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(x.isNegativeZero(e))return"-0.0";return t=e.toString(10),Ge.test(t)?t.replace("e",".e"):t}function We(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||x.isNegativeZero(e))}var Qe=new h("tag:yaml.org,2002:float",{kind:"scalar",resolve:Ke,construct:ze,predicate:We,represent:Ve,defaultStyle:"lowercase"}),Ze=Ce.extend({implicit:[Le,Me,qe,Qe]}),Xe=Ze,W=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Q=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Je(e){return e===null?!1:W.exec(e)!==null||Q.exec(e)!==null}function er(e){var r,t,n,i,s,a,o,l=0,u=null,f,p,c;if(r=W.exec(e),r===null&&(r=Q.exec(e)),r===null)throw new Error("Date resolve error");if(t=+r[1],n=+r[2]-1,i=+r[3],!r[4])return new Date(Date.UTC(t,n,i));if(s=+r[4],a=+r[5],o=+r[6],r[7]){for(l=r[7].slice(0,3);l.length<3;)l+="0";l=+l}return r[9]&&(f=+r[10],p=+(r[11]||0),u=(f*60+p)*6e4,r[9]==="-"&&(u=-u)),c=new Date(Date.UTC(t,n,i,s,a,o,l)),u&&c.setTime(c.getTime()-u),c}function rr(e){return e.toISOString()}var tr=new h("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Je,construct:er,instanceOf:Date,represent:rr});function nr(e){return e==="<<"||e===null}var ir=new h("tag:yaml.org,2002:merge",{kind:"scalar",resolve:nr}),D=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function ar(e){if(e===null)return!1;var r,t,n=0,i=e.length,s=D;for(t=0;t<i;t++)if(r=s.indexOf(e.charAt(t)),!(r>64)){if(r<0)return!1;n+=6}return n%8===0}function sr(e){var r,t,n=e.replace(/[\r\n=]/g,""),i=n.length,s=D,a=0,o=[];for(r=0;r<i;r++)r%4===0&&r&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|s.indexOf(n.charAt(r));return t=i%4*6,t===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):t===18?(o.push(a>>10&255),o.push(a>>2&255)):t===12&&o.push(a>>4&255),new Uint8Array(o)}function or(e){var r="",t=0,n,i,s=e.length,a=D;for(n=0;n<s;n++)n%3===0&&n&&(r+=a[t>>18&63],r+=a[t>>12&63],r+=a[t>>6&63],r+=a[t&63]),t=(t<<8)+e[n];return i=s%3,i===0?(r+=a[t>>18&63],r+=a[t>>12&63],r+=a[t>>6&63],r+=a[t&63]):i===2?(r+=a[t>>10&63],r+=a[t>>4&63],r+=a[t<<2&63],r+=a[64]):i===1&&(r+=a[t>>2&63],r+=a[t<<4&63],r+=a[64],r+=a[64]),r}function lr(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}var ur=new h("tag:yaml.org,2002:binary",{kind:"scalar",resolve:ar,construct:sr,predicate:lr,represent:or}),cr=Object.prototype.hasOwnProperty,fr=Object.prototype.toString;function pr(e){if(e===null)return!0;var r=[],t,n,i,s,a,o=e;for(t=0,n=o.length;t<n;t+=1){if(i=o[t],a=!1,fr.call(i)!=="[object Object]")return!1;for(s in i)if(cr.call(i,s))if(!a)a=!0;else return!1;if(!a)return!1;if(r.indexOf(s)===-1)r.push(s);else return!1}return!0}function hr(e){return e!==null?e:[]}var mr=new h("tag:yaml.org,2002:omap",{kind:"sequence",resolve:pr,construct:hr}),gr=Object.prototype.toString;function dr(e){if(e===null)return!0;var r,t,n,i,s,a=e;for(s=new Array(a.length),r=0,t=a.length;r<t;r+=1){if(n=a[r],gr.call(n)!=="[object Object]"||(i=Object.keys(n),i.length!==1))return!1;s[r]=[i[0],n[i[0]]]}return!0}function xr(e){if(e===null)return[];var r,t,n,i,s,a=e;for(s=new Array(a.length),r=0,t=a.length;r<t;r+=1)n=a[r],i=Object.keys(n),s[r]=[i[0],n[i[0]]];return s}var yr=new h("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:dr,construct:xr}),vr=Object.prototype.hasOwnProperty;function Sr(e){if(e===null)return!0;var r,t=e;for(r in t)if(vr.call(t,r)&&t[r]!==null)return!1;return!0}function Ar(e){return e!==null?e:{}}var Er=new h("tag:yaml.org,2002:set",{kind:"mapping",resolve:Sr,construct:Ar}),wr=Xe.extend({implicit:[tr,ir],explicit:[ur,mr,yr,Er]});function B(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?" ":e===76?"\u2028":e===80?"\u2029":""}var _r=new Array(256),Fr=new Array(256);for(var y=0;y<256;y++)_r[y]=B(y)?1:0,Fr[y]=B(y);var Z=Object.prototype.toString,X=Object.prototype.hasOwnProperty,P=65279,Or=9,_=10,Tr=13,Cr=32,Nr=33,Rr=34,R=35,Ir=37,Lr=38,br=39,Dr=42,J=44,Pr=45,T=58,Mr=61,kr=62,Br=63,Yr=64,ee=91,re=93,Ur=96,te=123,jr=124,ne=125,m={};m[0]="\\0";m[7]="\\a";m[8]="\\b";m[9]="\\t";m[10]="\\n";m[11]="\\v";m[12]="\\f";m[13]="\\r";m[27]="\\e";m[34]='\\"';m[92]="\\\\";m[133]="\\N";m[160]="\\_";m[8232]="\\L";m[8233]="\\P";var Hr=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],qr=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function $r(e,r){var t,n,i,s,a,o,l;if(r===null)return{};for(t={},n=Object.keys(r),i=0,s=n.length;i<s;i+=1)a=n[i],o=String(r[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&X.call(l.styleAliases,o)&&(o=l.styleAliases[o]),t[a]=o;return t}function Kr(e){var r,t,n;if(r=e.toString(16).toUpperCase(),e<=255)t="x",n=2;else if(e<=65535)t="u",n=4;else if(e<=4294967295)t="U",n=8;else throw new g("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+t+x.repeat("0",n-r.length)+r}var zr=1,F=2;function Gr(e){this.schema=e.schema||wr,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=x.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=$r(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?F:zr,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function Y(e,r){for(var t=x.repeat(" ",r),n=0,i=-1,s="",a,o=e.length;n<o;)i=e.indexOf(`
`,n),i===-1?(a=e.slice(n),n=o):(a=e.slice(n,i+1),n=i+1),a.length&&a!==`
`&&(s+=t),s+=a;return s}function I(e,r){return`
`+x.repeat(" ",e.indent*r)}function Vr(e,r){var t,n,i;for(t=0,n=e.implicitTypes.length;t<n;t+=1)if(i=e.implicitTypes[t],i.resolve(r))return!0;return!1}function C(e){return e===Cr||e===Or}function O(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==P||65536<=e&&e<=1114111}function U(e){return O(e)&&e!==P&&e!==Tr&&e!==_}function j(e,r,t){var n=U(e),i=n&&!C(e);return(t?n:n&&e!==J&&e!==ee&&e!==re&&e!==te&&e!==ne)&&e!==R&&!(r===T&&!i)||U(r)&&!C(r)&&e===R||r===T&&i}function Wr(e){return O(e)&&e!==P&&!C(e)&&e!==Pr&&e!==Br&&e!==T&&e!==J&&e!==ee&&e!==re&&e!==te&&e!==ne&&e!==R&&e!==Lr&&e!==Dr&&e!==Nr&&e!==jr&&e!==Mr&&e!==kr&&e!==br&&e!==Rr&&e!==Ir&&e!==Yr&&e!==Ur}function Qr(e){return!C(e)&&e!==T}function E(e,r){var t=e.charCodeAt(r),n;return t>=55296&&t<=56319&&r+1<e.length&&(n=e.charCodeAt(r+1),n>=56320&&n<=57343)?(t-55296)*1024+n-56320+65536:t}function ie(e){var r=/^\n* /;return r.test(e)}var ae=1,L=2,se=3,oe=4,v=5;function Zr(e,r,t,n,i,s,a,o){var l,u=0,f=null,p=!1,c=!1,M=n!==-1,S=-1,A=Wr(E(e,0))&&Qr(E(e,e.length-1));if(r||a)for(l=0;l<e.length;u>=65536?l+=2:l++){if(u=E(e,l),!O(u))return v;A=A&&j(u,f,o),f=u}else{for(l=0;l<e.length;u>=65536?l+=2:l++){if(u=E(e,l),u===_)p=!0,M&&(c=c||l-S-1>n&&e[S+1]!==" ",S=l);else if(!O(u))return v;A=A&&j(u,f,o),f=u}c=c||M&&l-S-1>n&&e[S+1]!==" "}return!p&&!c?A&&!a&&!i(e)?ae:s===F?v:L:t>9&&ie(e)?v:a?s===F?v:L:c?oe:se}function Xr(e,r,t,n,i){e.dump=function(){if(r.length===0)return e.quotingType===F?'""':"''";if(!e.noCompatMode&&(Hr.indexOf(r)!==-1||qr.test(r)))return e.quotingType===F?'"'+r+'"':"'"+r+"'";var s=e.indent*Math.max(1,t),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),o=n||e.flowLevel>-1&&t>=e.flowLevel;function l(u){return Vr(e,u)}switch(Zr(r,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!n,i)){case ae:return r;case L:return"'"+r.replace(/'/g,"''")+"'";case se:return"|"+H(r,e.indent)+q(Y(r,s));case oe:return">"+H(r,e.indent)+q(Y(Jr(r,a),s));case v:return'"'+et(r)+'"';default:throw new g("impossible error: invalid scalar style")}}()}function H(e,r){var t=ie(e)?String(r):"",n=e[e.length-1]===`
`,i=n&&(e[e.length-2]===`
`||e===`
`),s=i?"+":n?"":"-";return t+s+`
`}function q(e){return e[e.length-1]===`
`?e.slice(0,-1):e}function Jr(e,r){for(var t=/(\n+)([^\n]*)/g,n=function(){var u=e.indexOf(`
`);return u=u!==-1?u:e.length,t.lastIndex=u,$(e.slice(0,u),r)}(),i=e[0]===`
`||e[0]===" ",s,a;a=t.exec(e);){var o=a[1],l=a[2];s=l[0]===" ",n+=o+(!i&&!s&&l!==""?`
`:"")+$(l,r),i=s}return n}function $(e,r){if(e===""||e[0]===" ")return e;for(var t=/ [^ ]/g,n,i=0,s,a=0,o=0,l="";n=t.exec(e);)o=n.index,o-i>r&&(s=a>i?a:o,l+=`
`+e.slice(i,s),i=s+1),a=o;return l+=`
`,e.length-i>r&&a>i?l+=e.slice(i,a)+`
`+e.slice(a+1):l+=e.slice(i),l.slice(1)}function et(e){for(var r="",t=0,n,i=0;i<e.length;t>=65536?i+=2:i++)t=E(e,i),n=m[t],!n&&O(t)?(r+=e[i],t>=65536&&(r+=e[i+1])):r+=n||Kr(t);return r}function rt(e,r,t){var n="",i=e.tag,s,a,o;for(s=0,a=t.length;s<a;s+=1)o=t[s],e.replacer&&(o=e.replacer.call(t,String(s),o)),(d(e,r,o,!1,!1)||typeof o>"u"&&d(e,r,null,!1,!1))&&(n!==""&&(n+=","+(e.condenseFlow?"":" ")),n+=e.dump);e.tag=i,e.dump="["+n+"]"}function K(e,r,t,n){var i="",s=e.tag,a,o,l;for(a=0,o=t.length;a<o;a+=1)l=t[a],e.replacer&&(l=e.replacer.call(t,String(a),l)),(d(e,r+1,l,!0,!0,!1,!0)||typeof l>"u"&&d(e,r+1,null,!0,!0,!1,!0))&&((!n||i!=="")&&(i+=I(e,r)),e.dump&&_===e.dump.charCodeAt(0)?i+="-":i+="- ",i+=e.dump);e.tag=s,e.dump=i||"[]"}function tt(e,r,t){var n="",i=e.tag,s=Object.keys(t),a,o,l,u,f;for(a=0,o=s.length;a<o;a+=1)f="",n!==""&&(f+=", "),e.condenseFlow&&(f+='"'),l=s[a],u=t[l],e.replacer&&(u=e.replacer.call(t,l,u)),d(e,r,l,!1,!1)&&(e.dump.length>1024&&(f+="? "),f+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),d(e,r,u,!1,!1)&&(f+=e.dump,n+=f));e.tag=i,e.dump="{"+n+"}"}function nt(e,r,t,n){var i="",s=e.tag,a=Object.keys(t),o,l,u,f,p,c;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new g("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)c="",(!n||i!=="")&&(c+=I(e,r)),u=a[o],f=t[u],e.replacer&&(f=e.replacer.call(t,u,f)),d(e,r+1,u,!0,!0,!0)&&(p=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,p&&(e.dump&&_===e.dump.charCodeAt(0)?c+="?":c+="? "),c+=e.dump,p&&(c+=I(e,r)),d(e,r+1,f,!0,p)&&(e.dump&&_===e.dump.charCodeAt(0)?c+=":":c+=": ",c+=e.dump,i+=c));e.tag=s,e.dump=i||"{}"}function z(e,r,t){var n,i,s,a,o,l;for(i=t?e.explicitTypes:e.implicitTypes,s=0,a=i.length;s<a;s+=1)if(o=i[s],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof r=="object"&&r instanceof o.instanceOf)&&(!o.predicate||o.predicate(r))){if(t?o.multi&&o.representName?e.tag=o.representName(r):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,Z.call(o.represent)==="[object Function]")n=o.represent(r,l);else if(X.call(o.represent,l))n=o.represent[l](r,l);else throw new g("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=n}return!0}return!1}function d(e,r,t,n,i,s,a){e.tag=null,e.dump=t,z(e,t,!1)||z(e,t,!0);var o=Z.call(e.dump),l=n,u;n&&(n=e.flowLevel<0||e.flowLevel>r);var f=o==="[object Object]"||o==="[object Array]",p,c;if(f&&(p=e.duplicates.indexOf(t),c=p!==-1),(e.tag!==null&&e.tag!=="?"||c||e.indent!==2&&r>0)&&(i=!1),c&&e.usedDuplicates[p])e.dump="*ref_"+p;else{if(f&&c&&!e.usedDuplicates[p]&&(e.usedDuplicates[p]=!0),o==="[object Object]")n&&Object.keys(e.dump).length!==0?(nt(e,r,e.dump,i),c&&(e.dump="&ref_"+p+e.dump)):(tt(e,r,e.dump),c&&(e.dump="&ref_"+p+" "+e.dump));else if(o==="[object Array]")n&&e.dump.length!==0?(e.noArrayIndent&&!a&&r>0?K(e,r-1,e.dump,i):K(e,r,e.dump,i),c&&(e.dump="&ref_"+p+e.dump)):(rt(e,r,e.dump),c&&(e.dump="&ref_"+p+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&Xr(e,e.dump,r,s,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new g("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(u=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?u="!"+u:u.slice(0,18)==="tag:yaml.org,2002:"?u="!!"+u.slice(18):u="!<"+u+">",e.dump=u+" "+e.dump)}return!0}function it(e,r){var t=[],n=[],i,s;for(b(e,t,n),i=0,s=n.length;i<s;i+=1)r.duplicates.push(t[n[i]]);r.usedDuplicates=new Array(s)}function b(e,r,t){var n,i,s;if(e!==null&&typeof e=="object")if(i=r.indexOf(e),i!==-1)t.indexOf(i)===-1&&t.push(i);else if(r.push(e),Array.isArray(e))for(i=0,s=e.length;i<s;i+=1)b(e[i],r,t);else for(n=Object.keys(e),i=0,s=n.length;i<s;i+=1)b(e[n[i]],r,t)}function at(e,r){r=r||{};var t=new Gr(r);t.noRefs||it(e,t);var n=e;return t.replacer&&(n=t.replacer.call({"":n},"",n)),d(t,0,n,!0,!0)?t.dump+`
`:""}var st=at,ot={dump:st},lt=ot.dump;class ut{async exportToOpenAPI(r,t){const n=this.generateOpenAPIDocument(r,t);return{format:"yaml",content:lt(n,{indent:2,lineWidth:120,noRefs:!0}),filename:`${this.sanitizeFilename(t.title)}-openapi.yaml`}}async exportToJSON(r,t){const n=this.generateOpenAPIDocument(r,t);return{format:"json",content:JSON.stringify(n,null,2),filename:`${this.sanitizeFilename(t.title)}-openapi.json`}}async exportRawData(r){const t={exportTime:new Date().toISOString(),totalRecords:r.length,records:r};return{format:"json",content:JSON.stringify(t,null,2),filename:`api-records-${new Date().toISOString().split("T")[0]}.json`}}generateOpenAPIDocument(r,t){const n=this.generatePaths(r,t),i=this.generateServers(r,t.serverUrl),s=this.generateComponents(r,t);return{openapi:"3.0.3",info:{title:t.title,version:t.version,description:t.description||`API documentation generated from recorded requests on ${new Date().toLocaleDateString()}`},servers:i,paths:n,components:s}}generatePaths(r,t){const n=new Map;r.forEach(s=>{const a=t.parameterizeUrls?this.parameterizePath(s.url):this.extractPath(s.url);n.has(a)||n.set(a,new Map);const o=n.get(a),l=s.method.toLowerCase();o.has(l)||o.set(l,[]),o.get(l).push(s)});const i={};return n.forEach((s,a)=>{const o={};s.forEach((l,u)=>{o[u]=this.generateOperation(l,u,t)}),i[a]=o}),i}generateOperation(r,t,n){const i=this.selectPrimaryRecord(r),s={summary:this.generateOperationSummary(i,t),description:this.generateOperationDescription(r),parameters:this.generateParameters(r),responses:this.generateResponses(r,n)},a=this.generateRequestBody(r,n);a&&(s.requestBody=a);const o=this.generateTags(i);return o.length>0&&(s.tags=o),s}selectPrimaryRecord(r){return r.reduce((t,n)=>{if(n.responseStatus>=200&&n.responseStatus<300)return t.responseStatus<200||t.responseStatus>=300||n.timestamp>t.timestamp?n:t;const i=this.countParameters(n),s=this.countParameters(t);return i>s?n:t})}countParameters(r){let t=0;try{const n=new URL(r.url);t+=n.searchParams.size}catch{}return r.requestBody&&typeof r.requestBody=="object"&&(t+=Object.keys(r.requestBody).length),t}generateOperationSummary(r,t){const i=this.extractPath(r.url).split("/").filter(Boolean);if(i.length===0)return`${t.toUpperCase()} root`;const a=i[i.length-1].replace(/[{}]/g,"");return`${{get:"Get",post:"Create",put:"Update",patch:"Update",delete:"Delete",options:"Options for"}[t]||t.toUpperCase()} ${a}`}generateOperationDescription(r){const t=[...new Set(r.map(o=>o.responseStatus))].sort(),n=r.map(o=>new Date(o.timestamp)),i=new Date(Math.min(...n.map(o=>o.getTime()))),s=new Date(Math.max(...n.map(o=>o.getTime())));let a=`This endpoint was recorded from ${r.length} request(s). `;return a+=`First seen: ${i.toLocaleString()}, `,a+=`Last seen: ${s.toLocaleString()}. `,a+=`Response status codes observed: ${t.join(", ")}.`,a}generateParameters(r){const t=new Map;return r.forEach(n=>{try{const i=new URL(n.url);this.extractPathParameters(i.pathname).forEach(a=>{t.has(`path:${a.name}`)||t.set(`path:${a.name}`,{name:a.name,in:"path",required:!0,schema:{type:"string"},description:`Path parameter extracted from ${i.pathname}`})}),i.searchParams.forEach((a,o)=>{t.has(`query:${o}`)||t.set(`query:${o}`,{name:o,in:"query",required:!1,schema:this.inferSchemaFromValue(a),description:"Query parameter observed in requests"})}),Object.entries(n.headers).forEach(([a,o])=>{this.isCustomHeader(a)&&!t.has(`header:${a}`)&&t.set(`header:${a}`,{name:a,in:"header",required:!1,schema:{type:"string"},description:"Custom header observed in requests"})})}catch(i){console.warn("Error parsing URL for parameters:",n.url,i)}}),Array.from(t.values())}extractPathParameters(r){const t=[];return r.split("/").forEach((i,s)=>{/^\d+$/.test(i)?t.push({name:`id${t.length>0?t.length+1:""}`,pattern:i}):/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(i)&&t.push({name:`uuid${t.length>0?t.length+1:""}`,pattern:i})}),t}isCustomHeader(r){return!new Set(["accept","accept-encoding","accept-language","authorization","cache-control","connection","content-length","content-type","cookie","host","origin","referer","user-agent"]).has(r.toLowerCase())&&!r.toLowerCase().startsWith("sec-")}generateRequestBody(r,t){const n=r.filter(o=>o.requestBody);if(n.length===0)return;const i=new Set,s=new Map;n.forEach(o=>{const l=o.headers["content-type"]||"application/json";if(i.add(l.split(";")[0]),!s.has(l)&&o.requestBody){const u=this.generateSchemaFromData(o.requestBody,t);s.set(l,u)}});const a={};return i.forEach(o=>{const l=s.get(o);l&&(a[o]={schema:l,...t.includeExamples&&{example:n[0].requestBody}})}),{description:"Request body based on recorded requests",content:a,required:!0}}generateResponses(r,t){const n=new Map;r.forEach(s=>{const a=s.responseStatus;n.has(a)||n.set(a,[]),n.get(a).push(s)});const i={};return n.forEach((s,a)=>{const l={description:this.getStatusDescription(a)},u=this.generateResponseHeaders(s);Object.keys(u).length>0&&(l.headers=u);const f=this.generateResponseContent(s,t);Object.keys(f).length>0&&(l.content=f),i[a.toString()]=l}),i}generateResponseHeaders(r){const t=new Map;r.forEach(i=>{Object.entries(i.responseHeaders).forEach(([s,a])=>{this.isImportantResponseHeader(s)&&(t.has(s)||t.set(s,new Set),t.get(s).add(a))})});const n={};return t.forEach((i,s)=>{n[s]={description:`Response header observed in ${r.length} response(s)`,schema:{type:"string"}}}),n}isImportantResponseHeader(r){return new Set(["content-type","cache-control","etag","last-modified","location","set-cookie","x-rate-limit-remaining","x-total-count","x-pagination-page"]).has(r.toLowerCase())||r.toLowerCase().startsWith("x-")}generateResponseContent(r,t){const n=new Map;r.forEach(s=>{if(s.responseBody){const o=(s.responseHeaders["content-type"]||"application/json").split(";")[0];n.has(o)||n.set(o,[]),n.get(o).push(s.responseBody)}});const i={};return n.forEach((s,a)=>{const o=this.generateSchemaFromMultipleData(s,t);i[a]={schema:o,...t.includeExamples&&s.length>0&&{example:s[0]}}}),i}generateSchemaFromData(r,t){if(r==null)return{type:"string",nullable:!0};if(Array.isArray(r))return{type:"array",items:r.length>0?this.generateSchemaFromData(r[0],t):{type:"string"}};if(typeof r=="object"){const n={},i=[];return Object.entries(r).forEach(([s,a])=>{n[s]=this.generateSchemaFromData(a,t),a!=null&&i.push(s)}),{type:"object",properties:n,...i.length>0&&{required:i}}}return this.inferSchemaFromValue(r)}generateSchemaFromMultipleData(r,t){if(r.length===0)return{type:"string"};if(r.length===1)return this.generateSchemaFromData(r[0],t);const n=r.map(i=>this.generateSchemaFromData(i,t));return this.mergeSchemas(n)}mergeSchemas(r){if(r.length===0)return{type:"string"};if(r.length===1)return r[0];const t=new Set(r.map(n=>n.type));return t.size===1?Array.from(t)[0]==="object"?this.mergeObjectSchemas(r):r[0]:{oneOf:r}}mergeObjectSchemas(r){const t=new Map,n=new Set;r.forEach(s=>{s.properties&&Object.entries(s.properties).forEach(([a,o])=>{t.has(a)||t.set(a,[]),t.get(a).push(o)}),s.required&&s.required.forEach(a=>n.add(a))});const i={};return t.forEach((s,a)=>{i[a]=this.mergeSchemas(s)}),{type:"object",properties:i,required:Array.from(n)}}inferSchemaFromValue(r){return typeof r=="string"?/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/.test(r)?{type:"string",format:"date-time"}:/^\d{4}-\d{2}-\d{2}$/.test(r)?{type:"string",format:"date"}:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r)?{type:"string",format:"email"}:/^https?:\/\//.test(r)?{type:"string",format:"uri"}:{type:"string"}:typeof r=="number"?Number.isInteger(r)?{type:"integer"}:{type:"number"}:typeof r=="boolean"?{type:"boolean"}:{type:"string"}}generateServers(r,t){if(t&&t!=="auto")return[{url:t}];const n=new Set;return r.forEach(i=>{try{const s=new URL(i.url),a=`${s.protocol}//${s.host}`;n.add(a)}catch{}}),Array.from(n).map(i=>({url:i}))}generateComponents(r,t){return{}}generateTags(r){const t=[];try{const i=new URL(r.url).pathname.split("/").filter(Boolean);if(i.length>0){const s=i[0];if(s!=="api"&&s!=="v1"&&s!=="v2")t.push(s.charAt(0).toUpperCase()+s.slice(1));else if(i.length>1){const a=i[1];t.push(a.charAt(0).toUpperCase()+a.slice(1))}}}catch{}return t}getStatusDescription(r){return{200:"Successful response",201:"Resource created successfully",204:"No content",400:"Bad request",401:"Unauthorized",403:"Forbidden",404:"Resource not found",405:"Method not allowed",422:"Validation error",500:"Internal server error",502:"Bad gateway",503:"Service unavailable"}[r]||`HTTP ${r}`}parameterizePath(r){try{let n=new URL(r).pathname;return n=n.replace(/\/\d+/g,"/{id}"),n=n.replace(/\/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/gi,"/{uuid}"),n}catch{return r}}extractPath(r){try{return new URL(r).pathname}catch{return r}}sanitizeFilename(r){return r.replace(/[^a-zA-Z0-9\-_]/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,"").toLowerCase()}}export{ut as OpenAPIExporter};
